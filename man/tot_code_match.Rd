% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tot_code_match.R
\name{tot_code_match}
\alias{tot_code_match}
\title{tot_code_match}
\usage{
tot_code_match(
  x,
  y,
  x_tot_code = {
     k <- as.list(rep("Total", ncol(x)))
     names(k) <- names(x)
    
    k
 },
  y_tot_code = {
     k <- as.list(rep("Total", ncol(y)))
     names(k) <- names(y)
    
    k
 },
  both = FALSE,
  complete_match = FALSE
)
}
\arguments{
\item{x}{x}

\item{y}{y}

\item{x_tot_code}{x_tot_code}

\item{y_tot_code}{y_tot_code}

\item{both}{}

\item{complete_match}{Kun for testing. TRUE skal gi samme svar, men ikke like rask kode.}
}
\value{
integer vector or list
}
\description{
Limits match to rows with total code in non-common dim columns
}
\examples{
z <- SSBtools::SSBtoolsData("sprt_emp_withEU")
z$age[z$age == "Y15-29"] <- "young"
z$age[z$age == "Y30-64"] <- "old"
geoDimList <- SSBtools::FindDimLists(z[, c("geo", "eu")], total = "Europe")[[1]]

mm1 <- SSBtools::ModelMatrix(z, list(age = "All", year = "AllYears", geo = "Europe"), 
                             crossTable = TRUE)
mm2 <- SSBtools::ModelMatrix(z, formula = ~age * year * eu + geo * age, crossTable = TRUE)
mm3 <- SSBtools::ModelMatrix(z, dimVar = 1:2, crossTable = TRUE)


tot_code1 <- find_tot_code(mm1$modelMatrix, mm1$crossTable)
tot_code2 <- find_tot_code(mm2$modelMatrix, mm2$crossTable)
tot_code3 <- find_tot_code(mm3$modelMatrix, mm3$crossTable)

mm1$crossTable[tot_code_selection(mm1$crossTable, tot_code1), ]
mm1$crossTable[tot_code_selection(mm1$crossTable, tot_code1[c(1, 3)]), ]
mm2$crossTable[tot_code_selection(mm2$crossTable, tot_code2[c(1, 2)]), ]
mm3$crossTable[tot_code_selection(mm3$crossTable, tot_code3[2]), ]

d <- mm1$crossTable
d$value <- 10 * 1:(nrow(d))

cbind(d, tot_code_replace(d, dim_var = c("age", "year", "geo"), tot_code1[c(2, 3)]))
cbind(d, tot_code_replace(d, dim_var = c("age", "year", "geo"), tot_code1[1]))


ma <- tot_code_match(mm3$crossTable, mm1$crossTable, tot_code3, tot_code1)

# Like koder kreves for match. Må altså ha samme total-koder. Det er det ikke her.
cbind(mm3$crossTable[!is.na(ma), ], mm1$crossTable[ma[!is.na(ma)], ]) 
}
\keyword{internal}
